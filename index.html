<!DOCTYPE html>
<html>
<head>
	<title>Creazone</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/uikit.min.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script src="js/uikit.min.js"></script>
    <script src="js/uikit-icons.min.js"></script>
    <link rel="manifest" href="/manifest.json">
</head>
<body>
	
	<center>
        <main>
            <div class="uk-card uk-card-default uk-card-body uk-width-1-2@m" id="container">
                <h3 class="uk-card-title" id="topic"></h3>
            </div>
        </main>
        <br>
        <button class="uk-button uk-button-primary" id="btn">New One!</button>
    </center>
</form>
<script type="text/javascript">
const topic = document.querySelector('#topic');
const main = document.querySelector('main');
let btn = document.querySelector('#btn');
    window.addEventListener('load',e=>{
        updateJoke();
        registerSW();
    });
     
async function updateJoke(){
    const res = await fetch("https://sv443.net/jokeapi/category/any");
    joke = await res.json();
    console.log(joke);
    let div = document.createElement('p');
    div.innerHTML = ' '+ (!('joke' in joke)?joke.setup + '\n ' +joke.delivery : joke.joke);
    topic.appendChild(div);
}

btn.addEventListener('click',e =>{
    topic.removeChild(topic.childNodes[0]);
    updateJoke();
});
async function registerSW(){
    if('serviceWorker' in navigator){
        try{
            await navigator.serviceWorker.register('./sw.js');
        }
        catch(e){
            console.log("Service Worker registration failed");
        }
    }
}

</script>
</body>
</html>